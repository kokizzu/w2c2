OBJLIST=$(filter-out llvm.o,$(patsubst %.c,%.o,$(wildcard *.c))) $(OBJS)

sys/bin/llvm: llvm.o
	$(MAKE) -f Submake $(OBJLIST)
	$(CC) $(CFLAGS) $(OBJLIST) llvm.o -o $@ $(LDFLAGS)

datasegments.o: llvm.c
	ld -r -b binary -o datasegments.o datasegments

llvm.o: CFLAGS += -O3

%.o: %.c
	$(CC) -I.. -O3 $(CFLAGS) -c $< -o $@
